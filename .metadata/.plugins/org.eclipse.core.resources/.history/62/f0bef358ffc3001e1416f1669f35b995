package in.thiru.rest;

import org.springframework.http.HttpHeaders;
import org.springframework.security.crypto.codec.Base64;
import org.springframework.web.reactive.function.client.WebClient;

public class WelcomeRestController {

	public String getMessage() {

		// Replace with the actual URL of the service hosting the /welcome endpoint
		String apiUrl = "http://localhost:8080/welcome";
		String username = "your-username";
		String password = "your-password";

		// Create WebClient
		WebClient webClient = WebClient.builder()
				.defaultHeader(HttpHeaders.AUTHORIZATION, "Basic " + getBasicAuth(username, password)).build();

		// Make the HTTP GET request
		String response = webClient.get().uri(apiUrl).retrieve().bodyToMono(String.class).block();

		// Print the response
		System.out.println("Response from Welcome Service: " + response);
		return response;

	}
	 private static String getBasicAuth(String username, String password) {
	        String auth = username + ":" + password;
	        @SuppressWarnings("deprecation")
			byte[] encodedAuth = Base64.encode(auth.getBytes());
	        return "Basic " + new String(encodedAuth);
	    }

}
